<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Continuous Time Stochastic Modelling using Template Model Builder • ctsmTMB</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="deps/Google_Sans_Code-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Continuous Time Stochastic Modelling using Template Model Builder">
<meta name="description" content="Perform state and parameter inference, and forecasting, in stochastic state-space systems using the ctsmTMB class. This class, built with the R6 package, provides a user-friendly interface for defining and handling state-space models. Inference is based on maximum likelihood estimation, with derivatives efficiently computed through automatic differentiation enabled by the TMB/RTMB packages (Kristensen et al., 2016) &lt;doi:10.18637/jss.v070.i05&gt;. The available inference methods include Kalman filters, in addition to a Laplace approximation-based smoothing method. For further details of these methods refer to the documentation of the CTSMR package &lt;https://ctsm.info/ctsmr-reference.pdf&gt; and Thygesen (2025) &lt;doi:10.48550/arXiv.2503.21358&gt;. Forecasting capabilities include moment predictions and stochastic path simulations, both implemented in C++ using Rcpp (Eddelbuettel et al., 2018) &lt;doi:10.1080/00031305.2017.1375990&gt; for computational efficiency.">
<meta property="og:description" content="Perform state and parameter inference, and forecasting, in stochastic state-space systems using the ctsmTMB class. This class, built with the R6 package, provides a user-friendly interface for defining and handling state-space models. Inference is based on maximum likelihood estimation, with derivatives efficiently computed through automatic differentiation enabled by the TMB/RTMB packages (Kristensen et al., 2016) &lt;doi:10.18637/jss.v070.i05&gt;. The available inference methods include Kalman filters, in addition to a Laplace approximation-based smoothing method. For further details of these methods refer to the documentation of the CTSMR package &lt;https://ctsm.info/ctsmr-reference.pdf&gt; and Thygesen (2025) &lt;doi:10.48550/arXiv.2503.21358&gt;. Forecasting capabilities include moment predictions and stochastic path simulations, both implemented in C++ using Rcpp (Eddelbuettel et al., 2018) &lt;doi:10.1080/00031305.2017.1375990&gt; for computational efficiency.">
<meta property="og:image" content="https://github.com/phillipbvetter/ctsmTMB/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ctsmTMB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/ctsmTMB.html">Getting Started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="articles/estimate.html">Estimation</a></li>
    <li><a class="dropdown-item" href="articles/predict.html">Prediction</a></li>
    <li><a class="dropdown-item" href="articles/simulate.html">Simulation</a></li>
    <li><a class="dropdown-item" href="articles/using_another_optimizer.html">Likelihood (Extracting Function Handlers)</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-math-details" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Math Details</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-math-details">
<li><a class="dropdown-item" href="articles/linear_kalman_filter.html">Linear Kalman Filter</a></li>
    <li><a class="dropdown-item" href="articles/extended_kalman_filter.html">Extended Kalman Filter</a></li>
    <li><a class="dropdown-item" href="articles/unscented_kalman_filter.html">Unscented Kalman Filter</a></li>
    <li><a class="dropdown-item" href="articles/laplace_approx.html">Laplace Smoother</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/phillipbvetter/ctsmTMB/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="ctsmtmb-">ctsmTMB <a class="anchor" aria-label="anchor" href="#ctsmtmb-"></a>
</h1>
</div>
<!-- Badges -->
<p><a href="https://CRAN.R-project.org/package=ctsmTMB" class="external-link"><img src="https://www.r-pkg.org/badges/version/ctsmTMB" alt="CRAN status"></a> <a href="https://github.com/phillipbvetter/ctsmTMB/actions/workflows/R-CMD-check.yaml"><img src="https://github.com/phillipbvetter/ctsmTMB/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://cran.rstudio.com/web/packages/ctsmTMB/index.html" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/ctsmTMB?color=brightgreen"></a> <!-- Package Description --></p>
</div>
<div class="section level1">
<h1 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h1>
<p>Welcome to this GitHub repository which hosts <strong>ctsmTMB</strong> <a href="https://phillipbvetter.github.io/ctsmTMB/index.html" class="external-link">(Continuous Time Stochastic Modelling using Template Model Builder)</a>, the intended successor of, and heavily inspired by, the <strong>CTSM</strong> package <a href="https://ctsm.info" class="external-link">(Continuous Time Stochastic Modelling)</a>. The purpose of the package is to facilitate a user-friendly tool for (state and parameter) inference, and forecasting, in (multi-dimensional) continuous-discrete stochastic state space systems, i.e. systems on the form</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><msub><mi>x</mi><mi>t</mi></msub><mo>,</mo><msub><mi>u</mi><mi>t</mi></msub><mo>,</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>t</mi><mo>+</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><msub><mi>x</mi><mi>t</mi></msub><mo>,</mo><msub><mi>u</mi><mi>t</mi></msub><mo>,</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
dx_{t} = f\left( t, x_t, u_t, p \right) dt + g\left( t, x_t, u_t, p \right) dB_{t}
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub><mo>=</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>k</mi></msub><mo>,</mo><msub><mi>x</mi><msub><mi>t</mi><mi>k</mi></msub></msub><mo>,</mo><msub><mi>u</mi><msub><mi>t</mi><mi>k</mi></msub></msub><mo>,</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
y_{k} = h\left( t_k, x_{t_k}, u_{t_k}, p \right)
</annotation></semantics></math></p>
<p>Here the latent state <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>t</mi></msub><annotation encoding="application/x-tex">x_t</annotation></semantics></math> evolves continuously in time, governed by a set of stochastic differential equations, and information about the system is available at discrete times <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>k</mi></msub><annotation encoding="application/x-tex">t_{k}</annotation></semantics></math> by the observations <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>k</mi></msub><annotation encoding="application/x-tex">y_{k}</annotation></semantics></math>.</p>
<p>The <strong>ctsmTMB</strong> package is essentially wrapper around the <strong>TMB/RTMB</strong> packages <a href="https://github.com/kaskr/adcomp" class="external-link">(Template Model Builder)</a> that provide automatic differentiation of the likelihood function, and access to other computational tools such as the Laplace approximation. The likelihood function is constructed based on the (symbolic) user-provided state space equations, which may be specified using the implemented OOP-style <strong>R6</strong> <code>ctsmTMB</code> class, with methods such as <code>addSystem</code> (for defining system equations), and <code>addObs</code> (for defining observation equations).</p>
<p>The primary work-horse of <strong>ctsmTMB</strong> is the <code>estimate</code> method, which carries out inference by minimizing the (negative log) likelihood using the <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb</a></code> quasi-Newton optimizer. The resulting object contains the maximum likelihood parameter and state estimates, and associated marginal uncertainties. The available inference methods are the Linear and Extended Kalman filters in addition to filtration (actually smoothing) using a Laplace approximation approach. <!-- The user can extract the likelihood function handles (function, gradient and hessian) with the `likelihood` method if e.g. they want to use another optimizer. --></p>
<p>The package facilities forecasting through the <code>predict</code> (moment forecasts) and <code>simulate</code> (stochastic path simulations) methods. The calculations for these may be carried out in either <strong>R</strong> (default) or for additional speed in <strong>C++</strong> using <code>Rcpp</code>. <!-- in particular using the `RcppXPtrUtils` package for sending **C++** pointers of the model-specific functions (drift, diffusion, observation and jacobians) rather than sending (slow to evaluate) **R** functions. --></p>
<!-- Estimation Methods -->
</div>
<div class="section level1">
<h1 id="estimation-methods">Estimation Methods<a class="anchor" aria-label="anchor" href="#estimation-methods"></a>
</h1>
<p>The following state reconstruction algorithms are currently available:</p>
<ol style="list-style-type: decimal">
<li><p>The Linear Kalman Filter, <code>lkf</code>.</p></li>
<li><p>The Extended Kalman Filter, <code>ekf</code>.</p></li>
<li><p>The Unscented Kalman Filter, <code>ukf</code>.</p></li>
<li><p>The Laplace Smoothers <code>laplace</code> and <code>laplace.thygesen</code>.</p></li>
</ol>
<div class="section level2">
<h2 id="kalman-filters">Kalman Filters<a class="anchor" aria-label="anchor" href="#kalman-filters"></a>
</h2>
<p>The package is currently mostly tailored towards the Kalman Filter. The advantages of the methods are:</p>
<ol style="list-style-type: decimal">
<li><p>The hessian of the likelihood function (w.r.t the fixed parameters) is available.</p></li>
<li><p>The model residuals are easier to compute for e.g. model validation.</p></li>
<li><p>Multi-step predictions / simulations with state updates are easier to compute.</p></li>
</ol>
<p>The Unscented Kalman Filter implementation is based on <em>Algorithm 4.7</em> in <a href="https://ieeexplore.ieee.org/document/4303242" class="external-link">S. Särkkä, 2007</a>.</p>
</div>
<div class="section level2">
<h2 id="laplace-smoother">Laplace Smoother<a class="anchor" aria-label="anchor" href="#laplace-smoother"></a>
</h2>
<p>The state-reconstructions based on the <code>laplace</code> (approximation) method are <em>smoothed</em> estimates, meaning that states are optimized jointly conditioned on all observations. The Laplace approximation is natively built-into and completely handled by <strong>TMB</strong>. The additional method <code>laplace.thygesen</code> is an implementation of the the stability-improved laplace method for systems with state-dependent diffusion and is due to <a href="https://arxiv.org/abs/2503.21358" class="external-link">Thygesen, 2025</a>.</p>
<p>A particular advantage of the Laplace smoother is:</p>
<ol style="list-style-type: decimal">
<li>The possibility for unimodal non-Gaussian observation densities to accommodate the need for e.g. heavier distribution tails. <em>Not yet implemented</em>.</li>
</ol>
<!-- Installation -->
</div>
</div>
<div class="section level1">
<h1 id="installation-compilers">Installation (Compilers)<a class="anchor" aria-label="anchor" href="#installation-compilers"></a>
</h1>
<p><strong>NOTE: YOU NEED TO MAKE SURE YOU HAVE A WORKING C++ COMPILER IN R TO INSTALL THE PACKAGE!!</strong></p>
<div class="section level2">
<h2 id="windows">Windows<a class="anchor" aria-label="anchor" href="#windows"></a>
</h2>
<p>C++ compilation in R requires <strong>Rtools</strong>:</p>
<ol style="list-style-type: decimal">
<li><p>Go to <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link uri">https://cran.r-project.org/bin/windows/Rtools/</a> and find the latest version.</p></li>
<li><p>Go to “Control Panel -&gt; System -&gt;”Advanced” (tab) -&gt; “Environment Variables” -&gt; Highlight “Path” -&gt; “Edit” -&gt; Add to the character string in “Variable Value” the path to your Rtools folder **C:;C:*.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="mac--unix">Mac / Unix<a class="anchor" aria-label="anchor" href="#mac--unix"></a>
</h2>
<p>Mac users should install <em>Command Line Tools</em>. Run the following command in the Terminal</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">xcode-select</span> <span class="at">--install</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="installation-package">Installation (Package)<a class="anchor" aria-label="anchor" href="#installation-package"></a>
</h1>
<p>The package can be installed from source from CRAN:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ctsmTMB"</span>, type<span class="op">=</span><span class="st">"source"</span><span class="op">)</span></span></code></pre></div>
<p>The development version is available on GitHub and R-universe:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span>repo<span class="op">=</span><span class="st">"phillipbvetter/ctsmTMB"</span>, dependencies<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'ctsmTMB'</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'https://phillipbvetter.r-universe.dev'</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"source"</span><span class="op">)</span></span></code></pre></div>
<p>If you encounter problems with a locked folder <code>00LOCK-ctsmTMB</code> due to a previously failed installation remove it before reinstalling</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enter the path on your system</span></span>
<span><span class="va">enter.your.path</span> <span class="op">&lt;-</span> <span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/00LOCK-ctsmTMB"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">enter.your.path</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="test-installation">Test Installation<a class="anchor" aria-label="anchor" href="#test-installation"></a>
</h2>
<p>Once you have installed the package is it a good idea to test whether <strong>TMB</strong> and C++ compilation works. You should be able to run all examples without compilation errors:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaskr/adcomp/wiki" class="external-link">TMB</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TMB/man/runExample.html" class="external-link">runExample</a></span><span class="op">(</span>all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>For further information see the <a href="https://github.com/kaskr/adcomp" class="external-link">TMB GitHub</a> and its associated <a href="https://github.com/kaskr/adcomp/wiki/Download" class="external-link">installation instructions</a>.</p>
</div>
</div>
<div class="section level1">
<h1 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h1>
<p>You can visit the package <a href="https://phillipbvetter.github.io/ctsmTMB/index.html" class="external-link">webpage</a> and browse the vignettes for example uses, in particular see <a href="https://phillipbvetter.github.io/ctsmTMB/articles/ctsmTMB.html" class="external-link">Getting Started</a>.</p>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>You can access the documentation for all methods with</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">ctsmTMB</span></span></code></pre></div>
<p>The methods documentation is also available on the <a href="https://phillipbvetter.github.io/ctsmTMB/reference/ctsmTMB.html" class="external-link">package homepage</a>.</p>
</div>
<div class="section level2">
<h2 id="code-example---inference-in-1d-ornstein-uhlenbeck-process">Code Example - Inference in 1D Ornstein-Uhlenbeck Process<a class="anchor" aria-label="anchor" href="#code-example---inference-in-1d-ornstein-uhlenbeck-process"></a>
</h2>
<p>We consider estimating the parameters of the modified Ornstein-Uhlenbeck process</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mi>θ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>+</mo><msub><mi>u</mi><mi>t</mi></msub><mo>−</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>t</mi><mo>+</mo><msub><mi>σ</mi><mi>x</mi></msub><mi>d</mi><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
dx_{t} = \theta \left( \mu + u_t - x_t \right) dt + \sigma_x dB_{t}
</annotation></semantics></math></p>
<p>where the stationary mean <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math> has been augmented with the addition of a time-varying input <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>t</mi></msub><annotation encoding="application/x-tex">u_{t}</annotation></semantics></math>. The observations remain linear and Gaussian:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub><mo>=</mo><msub><mi>x</mi><msub><mi>t</mi><mi>k</mi></msub></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mspace width="2.0em"></mspace><msub><mi>ε</mi><mi>t</mi></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>y</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
y_{k} = x_{t_k} + \varepsilon_{t} \qquad \varepsilon_{t} \sim \mathcal{N}\left(0, \sigma_{y}^2 \right)
</annotation></semantics></math></p>
<p>The code chunk below simulates data from this process using an Euler-Maruyama scheme, generates an appropriate <code>ctsmTMB</code> model object, performs parameter estimation using an Extended Kalman Filter (the Linear Kalman Filter <code>method='lkf'</code> could also be used) and inspects the resulting residuals, moment predictions and stochastic simulations.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/phillipbvetter/ctsmTMB">ctsmTMB</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">############################################################</span></span>
<span><span class="co"># Data simulation</span></span>
<span><span class="co">############################################################</span></span>
<span></span>
<span><span class="co"># Simulate data using Euler Maruyama</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">true.pars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>theta<span class="op">=</span><span class="fl">10</span>, mu<span class="op">=</span><span class="fl">1</span>, sigma_x<span class="op">=</span><span class="fl">1</span>, sigma_y<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co"># </span></span>
<span><span class="va">dt.sim</span> <span class="op">=</span> <span class="fl">1e-3</span></span>
<span><span class="va">t.sim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,by<span class="op">=</span><span class="va">dt.sim</span><span class="op">)</span></span>
<span><span class="va">dw</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dt.sim</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">u.sim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span>,sd<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x.sim</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x.sim</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">x.sim</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">true.pars</span><span class="op">[</span><span class="st">"theta"</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">true.pars</span><span class="op">[</span><span class="st">"mu"</span><span class="op">]</span><span class="op">-</span><span class="va">x.sim</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="va">u.sim</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">dt.sim</span> <span class="op">+</span> <span class="va">true.pars</span><span class="op">[</span><span class="st">"sigma_x"</span><span class="op">]</span><span class="op">*</span><span class="va">dw</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">df.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  t <span class="op">=</span> <span class="va">t.sim</span>,</span>
<span>  u <span class="op">=</span> <span class="va">u.sim</span>,</span>
<span>  x <span class="op">=</span> <span class="va">x.sim</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract simulation at observations time points, and create observations by adding noise</span></span>
<span><span class="va">dt.obs</span> <span class="op">=</span> <span class="fl">1e-2</span></span>
<span><span class="va">ids</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t.sim</span><span class="op">)</span>,by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dt.obs</span> <span class="op">/</span> <span class="va">dt.sim</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df.obs</span> <span class="op">&lt;-</span> <span class="va">df.sim</span><span class="op">[</span><span class="va">ids</span>,<span class="op">]</span></span>
<span><span class="va">df.obs</span><span class="op">$</span><span class="va">y</span> <span class="op">=</span> <span class="va">df.obs</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="va">true.pars</span><span class="op">[</span><span class="st">"sigma_y"</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df.obs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">############################################################</span></span>
<span><span class="co"># Model creation</span></span>
<span><span class="co">############################################################</span></span>
<span></span>
<span><span class="co"># Create model object</span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="va"><a href="reference/ctsmTMB.html">ctsmTMB</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add system equations</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">addSystem</span><span class="op">(</span></span>
<span>  <span class="va">dx</span> <span class="op">~</span> <span class="va">theta</span> <span class="op">*</span> <span class="op">(</span><span class="va">mu</span><span class="op">-</span><span class="va">x</span><span class="op">+</span><span class="va">u</span><span class="op">)</span> <span class="op">*</span> <span class="va">dt</span> <span class="op">+</span> <span class="va">sigma_x</span><span class="op">*</span><span class="va">dw</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add observation equations</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">addObs</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set observation equation variances</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">setVariance</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">sigma_y</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add vector input</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">addInput</span><span class="op">(</span><span class="va">u</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify parameter initial values and lower/upper bounds in estimation</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">setParameter</span><span class="op">(</span></span>
<span>  theta   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial <span class="op">=</span> <span class="fl">1</span>, lower<span class="op">=</span><span class="fl">1e-5</span>, upper<span class="op">=</span><span class="fl">50</span><span class="op">)</span>,</span>
<span>  mu      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial<span class="op">=</span><span class="fl">1.5</span>, lower<span class="op">=</span><span class="fl">0</span>, upper<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>  sigma_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial<span class="op">=</span><span class="fl">1</span>, lower<span class="op">=</span><span class="fl">1e-10</span>, upper<span class="op">=</span><span class="fl">30</span><span class="op">)</span>,</span>
<span>  sigma_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>initial<span class="op">=</span><span class="fl">1e-1</span>, lower<span class="op">=</span><span class="fl">1e-10</span>, upper<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial state mean and covariance</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">setInitialState</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x.sim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1e-1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">############################################################</span></span>
<span><span class="co"># Model estimation</span></span>
<span><span class="co">############################################################</span></span>
<span></span>
<span><span class="co"># Carry out estimation with default settings (extended kalman filter)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">estimate</span><span class="op">(</span><span class="va">df.obs</span>, method<span class="op">=</span><span class="st">"ekf"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check parameter estimates against truth</span></span>
<span><span class="va">fitted.pars</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">par.fixed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">true.pars</span>, <span class="va">fitted.pars</span>, difference<span class="op">=</span><span class="va">true.pars</span> <span class="op">-</span> <span class="va">fitted.pars</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Plot prior predictions (1-step predictions) against simulation (truth) and observations (data)</span></span>
<span><span class="va">df.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">mean</span><span class="op">$</span><span class="va">prior</span>, sd<span class="op">=</span><span class="va">fit</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">sd</span><span class="op">$</span><span class="va">prior</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">df.est</span><span class="op">$</span><span class="va">t</span>, y<span class="op">=</span><span class="va">df.est</span><span class="op">$</span><span class="va">x</span>, type<span class="op">=</span><span class="st">"n"</span>, main<span class="op">=</span><span class="st">"1-Step State Estimates vs Observations"</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">""</span>,  ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df.est</span><span class="op">$</span><span class="va">t</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">df.est</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df.est</span><span class="op">$</span><span class="va">x</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="va">df.est</span><span class="op">$</span><span class="va">sd</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">df.est</span><span class="op">$</span><span class="va">x</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">df.est</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"grey70"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">df.est</span><span class="op">$</span><span class="va">t</span>, <span class="va">df.est</span><span class="op">$</span><span class="va">x</span>, col<span class="op">=</span><span class="st">"steelblue"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">df.obs</span><span class="op">$</span><span class="va">t</span>, <span class="va">df.obs</span><span class="op">$</span><span class="va">y</span>, col<span class="op">=</span><span class="st">"tomato"</span>, pch<span class="op">=</span><span class="fl">16</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict to obtain k-step-ahead predictions to see model forecasting ability</span></span>
<span><span class="va">pred.10step</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">df.obs</span>, k.ahead<span class="op">=</span><span class="fl">10</span>, method<span class="op">=</span><span class="st">"ekf"</span>, return.k.ahead <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 10 step predictions vs data</span></span>
<span><span class="va">dfp</span> <span class="op">&lt;-</span> <span class="va">pred.10step</span><span class="op">$</span><span class="va">states</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t.j"</span>,<span class="st">"x"</span>,<span class="st">"var.x"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dfp</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">[</span><span class="st">"var.x"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t"</span>,<span class="st">"x"</span>,<span class="st">"var"</span>,<span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dfp</span><span class="op">$</span><span class="va">t</span>, y<span class="op">=</span><span class="va">dfp</span><span class="op">$</span><span class="va">x</span>, type<span class="op">=</span><span class="st">"n"</span>, main<span class="op">=</span><span class="st">"10 Step Predictions vs Observations"</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">$</span><span class="va">t</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">$</span><span class="va">x</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="va">dfp</span><span class="op">$</span><span class="va">sd</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">$</span><span class="va">x</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">dfp</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"grey70"</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">$</span><span class="va">t</span>, <span class="va">dfp</span><span class="op">$</span><span class="va">x</span>, col<span class="op">=</span><span class="st">"steelblue"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">df.obs</span><span class="op">$</span><span class="va">t</span>, <span class="va">df.obs</span><span class="op">$</span><span class="va">y</span>, col<span class="op">=</span><span class="st">"tomato"</span>, pch<span class="op">=</span><span class="fl">16</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform a full prediction i.e. without updating to data along the way</span></span>
<span><span class="va">dfp</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">df.obs</span>, method<span class="op">=</span><span class="st">"ekf"</span><span class="op">)</span><span class="op">$</span><span class="va">states</span></span>
<span></span>
<span><span class="co"># Perform full simulations - 10 sample trajectories</span></span>
<span><span class="va">sdf</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">df.obs</span>, method<span class="op">=</span><span class="st">"ekf"</span>, n.sims<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">states</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">i0</span></span>
<span><span class="va">sdf.sim</span> <span class="op">&lt;-</span> <span class="va">sdf</span><span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sdf</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sdf</span><span class="op">$</span><span class="va">t.j</span>, <span class="va">sdf.sim</span>, type<span class="op">=</span><span class="st">"l"</span>, lty<span class="op">=</span><span class="st">"solid"</span>, col<span class="op">=</span><span class="st">"grey70"</span>, main<span class="op">=</span><span class="st">"No Update Prediction and Simulations vs Observations"</span>, xlab<span class="op">=</span><span class="st">"Time"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">$</span><span class="va">t.j</span>, <span class="va">dfp</span><span class="op">$</span><span class="va">x</span>, col<span class="op">=</span><span class="st">"steelblue"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">df.obs</span><span class="op">$</span><span class="va">t</span>, <span class="va">df.obs</span><span class="op">$</span><span class="va">y</span>, col<span class="op">=</span><span class="st">"tomato"</span>, pch<span class="op">=</span><span class="fl">16</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform residual analysis</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<ul>
<li><p>U. H. Thygesen and K. Kristensen (2025), <em>“Inference in stochastic differential equations using the Laplace approximation: Demonstration and examples”</em>. In: <a href="https://arxiv.org/abs/2503.21358" class="external-link">arXiv:2503.21358v2</a>.</p></li>
<li><p>S. Särkkä, <em>“On Unscented Kalman Filtering for State Estimation of Continuous-Time Nonlinear Systems”</em>. In: <a href="https://ieeexplore.ieee.org/document/4303242" class="external-link">IEEE Transactions on Automatic Control, 52(9), 1631-1641</a>.</p></li>
</ul>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ctsmTMB" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/phillipbvetter/ctsmTMB/">Browse source code</a></li>
<li><a href="https://github.com/phillipbvetter/ctsmTMB/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ctsmTMB</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Phillip Vetter <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phillip Vetter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
